[mysqld]

# --------------------------------------
#  MEMORY / INNODB
# --------------------------------------
innodb_buffer_pool_size = 5G
innodb_buffer_pool_instances = 5
innodb_log_file_size = 512M
innodb_log_buffer_size = 256M
innodb_flush_method = O_DIRECT
innodb_flush_log_at_trx_commit = 2
innodb_file_per_table = 1
innodb_read_io_threads = 4
innodb_write_io_threads = 4

# --------------------------------------
#  CONNECTIONS / THREADS
# --------------------------------------
max_connections = 300
thread_cache_size = 100
table_open_cache = 4000
table_open_cache_instances = 4

# --------------------------------------
#  TEMP TABLES (IMPORTANT FOR REST API)
# --------------------------------------
tmp_table_size = 256M
max_heap_table_size = 256M

# --------------------------------------
#  QUERY CACHE (DISABLED FOR MARIADB 10.5+)
# --------------------------------------
query_cache_type = 0
query_cache_size = 0

# --------------------------------------
#  BINARY LOGGING (OPTIONAL BUT GOOD)
# --------------------------------------
binlog_format = ROW
expire_logs_days = 7

# --------------------------------------
#  SLOW QUERY LOG
# --------------------------------------
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 0.3  # Lower than 0.5 for WC/REST bottlenecks

# --------------------------------------
#  PERFORMANCE
# --------------------------------------
join_buffer_size = 8M
sort_buffer_size = 4M
read_buffer_size = 2M
read_rnd_buffer_size = 2M

# --------------------------------------
#  CHARACTER SET
# --------------------------------------
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
